<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Campionato</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.4/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-DQvkBjpPgn7RC31MCQoOeC9TI2kdqa4+BSgNMNj8v77fdC77Kj5zpWFTJaaAoMbC" crossorigin="anonymous">
    <%- include('../../shared/views/partials/theme-includes') %>
    <link rel="stylesheet" href="/assets/styles/Campionato.css">
    <link rel="stylesheet" href="/assets/styles/Navbar.css">
    <link rel="stylesheet" href="/assets/styles/Footer.css">
    <link rel="stylesheet" href="/assets/styles/theme-campionato.css">
</head>
<body>
    <%- include('partials/navbar') %>
    <div id="page">
        <br>
        <header class="container-fluid d-flex flex-column justify-content-center align-items-center">
            <h1 class="mb-4 text-center">Classifica Campionato</h1>
            <!-- Menu a tendina con margine sotto -->
            <div class="select-container">
                <select class="form-select form-select-sm custom-select" id="campionatoSelect" aria-label="Select menu">
                    <% campionati.forEach(campionato => { %>
                        <option value="<%= campionato.id %>" <%= selectedCampionato === campionato.id ? 'selected="selected"' : '' %>><%= campionato.nome %> - <%= campionato.stagione %></option>
                    <% }); %>
                </select>
            </div>
            <div class="table-responsive w-75">
                <table class="table table-sm">
                    <thead class="table-primary">
                        <tr>
                            <th scope="col">Pos</th>
                            <th scope="col">Squadra</th>
                            <th scope="col">Punti</th>
                        </tr>
                    </thead>
                    <tbody>
                        <% classifica.forEach(squadra => { %>
                            <tr class="<%= squadra.classe %>">
                                <th scope="row"><%= squadra.posizione %></th>
                                <td><%= squadra.nome %></td>
                                <td><%= squadra.punti %></td>
                            </tr>
                        <% }); %>
                    </tbody>
                </table>
            </div>
        </header>

        <section class="pt-4 justify-content-center align-items-center container-fluid d-flex">
            <div class="legend-box-container p-4 shadow-sm rounded-4 mb-4 w-100" style="max-width: 500px;">
                                <h5 class="mb-3 fw-semibold overflow-hidden">Legenda Classifica</h5>
                <ul class="list-unstyled d-flex flex-column gap-3 mb-0">
                    <li class="d-flex align-items-center gap-2">
                        <span class="legend-color bg-success"></span>
                        <span>Promozione diretta (1°-<%= regole.promozione_diretta || 2 %>°)</span>
                    </li>
                    <li class="d-flex align-items-center gap-2">
                        <span class="legend-color bg-secondary"></span>
                        <span>Playoff (<%= regole.playoff_start || 3 %>°-<%= regole.playoff_end || 6 %>°)</span>
                    </li>
                    <li class="d-flex align-items-center gap-2">
                        <span class="legend-color bg-warning"></span>
                        <span>Play-out (<%= regole.playout_start || 11 %>°-<%= regole.playout_end || 14 %>°)</span>
                    </li>
                    <li class="d-flex align-items-center gap-2">
                        <span class="legend-color bg-danger"></span>
                        <span>Retrocessione diretta (ultime <%= regole.retrocessione_diretta || 2 %>)</span>
                    </li>
                </ul>
            </div>
        </section>
    </div>
    <%- include('partials/footer') %>
    <!-- Script inline per forzare la selezione del campionato corretto -->
    <script>
        // Forza la selezione del campionato prima che altri script vengano caricati
        document.addEventListener('DOMContentLoaded', function() {
            const selectedId = <%= selectedCampionato %>;
            const select = document.getElementById('campionatoSelect');
            if (select && selectedId) {
                console.log('Forzando selezione campionato ID:', selectedId);
                select.value = selectedId;
                console.log('Select.value dopo forzatura:', select.value);
            }
        });
    </script>
    <script type="module">
        import Campionato from '/assets/scripts/components/Campionato.js';
        
        new Campionato(document.getElementById('page'));
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.4/dist/js/bootstrap.bundle.min.js" integrity="sha384-YUe2LzesAfftltw+PEaao2tjU/QATaW/rOitAq67e0CT0Zi2VVRL0oC4+gAaeBKu" crossorigin="anonymous"></script>
</body>
</html>