'use strict';

const nodemailer = require('nodemailer');

// Configurazione del transporter (da personalizzare con le credenziali reali)
// const transporter = nodemailer.createTransport({
//     host: process.env.SMTP_HOST || 'smtp.gmail.com',
//     port: process.env.SMTP_PORT || 587,
//     secure: false, // true per 465, false per altri port
//     auth: {
//         user: process.env.SMTP_USER || 'your-email@gmail.com',
//         pass: process.env.SMTP_PASS || 'your-app-password'
//     }
// });

class EmailService {
    async sendEmail({ fromName, fromEmail, subject, message }) {
        const mailOptions = {
            from: `"${fromName}" <${fromEmail}>`,
            to: process.env.CONTACT_EMAIL || 'contact@borgovercelli.it', // Email di destinazione
            subject: subject,
            text: message,
            html: `<p>${message.replace(/\n/g, '<br>')}</p>`
        };

        try {
            // Per MVP, simuliamo l'invio senza realmente inviare
            console.log('Simulazione invio email:', mailOptions);
            // const info = await transporter.sendMail(mailOptions);
            const info = { messageId: 'simulated-' + Date.now() };
            console.log('Email simulata inviata: %s', info.messageId);
            return info;
        } catch (error) {
            console.error('Errore invio email:', error);
            throw error;
        }
    }
}

module.exports = new EmailService();